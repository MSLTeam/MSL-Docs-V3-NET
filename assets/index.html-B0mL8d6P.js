import{_ as o,c as u,b as i,d as a,a as e,w as n,r as l,o as m}from"./app-8ulrsh2m.js";const c="/assets/image-20251111163735501-DEHpPkMR.png",h="/assets/image-20251111164801605-Bb1gZ1BY.png",g="/assets/image-20251111164954920-D7o44L1Z.png",v="/assets/image-20251111165023639-DXy4WBzD.png",k="/assets/image-20250518194152354-Clexp-KA.png",b="/assets/image-20250519124130518-DceomP98.png",f="/assets/image-20250519124318341-jHTCqi5_.png",q="/assets/image-20250519124415802-DNEgqOVT.png",y="/assets/image-20250519124520689-BCGbHEgG.png",A={},x={class:"vp-steps"},S={class:"vp-field-group"};function M(w,s){const t=l("VPField"),p=l("Badge"),r=l("Card"),d=l("RepoCard");return m(),u("div",null,[s[12]||(s[12]=i('<div class="hint-container tip"><p class="hint-container-title">TIPS</p><p>此处介绍的开发者将自己的服务 <mark>接入MSL统一身份验证</mark>（即MSL用户中心服务） <mark>第三方登录</mark> 。<br> 若您并不知道什么意思，那就别看啦~</p></div><h2 id="_1-申请oauth-app" tabindex="-1"><a class="header-anchor" href="#_1-申请oauth-app"><span>1.申请OAuth App</span></a></h2><p>进入MSL用户中心的OAuth App管理页面，点击添加应用。</p><p><a href="https://user.mslmc.net/user/oauth" class="readmore" target="_blank" rel="noopener noreferrer">MSL OAuth App管理</a></p><p><img src="'+c+'" alt="image-20251111163735501" width="2560" height="1229"></p><p>填写应用的 <mark>名字</mark>，<mark>图标</mark>（推荐正方形，需要是可以外部访问的url地址），以及您的App的 <mark>回调地址</mark> 。</p><p>注意：应用权限请保持默认的选择 <mark>用户信息</mark> 。</p><div class="hint-container tip"><p class="hint-container-title">关于应用权限</p><p>如果你只是需要调用MSL用户中心进行登录，那么选择 <mark>用户信息</mark> 是完全足够的。</p><p><mark>所有权限</mark> 是提供MSL账号的完全访问权限，仅适用于对接我们的其他服务（如MSLFrp），若您有这方面的需求，可以在Q群或者邮件联系我们商讨后为您开通相关权限。<a href="mailto:support@mslmc.cn" target="_blank" rel="noopener noreferrer">support@mslmc.cn</a></p></div><p><img src="'+h+'" alt="image-20251111164801605" width="669" height="403"></p><p>点击确定后，会返回您的App <mark>客户端ID</mark> 以及 <mark>密钥</mark> 信息。</p><div class="hint-container important"><p class="hint-container-title">注意</p><p>请妥善保管您的密钥，<mark class="important">密钥仅会显示一次</mark> 。 后续若忘记密钥就只能重置了。</p></div><p><img src="'+g+'" alt="image-20251111164954920" width="555" height="315"></p><p><img src="'+v+'" alt="image-20251111165023639" width="571" height="261"></p><div class="hint-container info"><p class="hint-container-title">审核</p><p>添加App后会进入待审核状态，请 <mark>联系管理员审核</mark> 。 否则App无法正常调用哦！</p></div><h2 id="_2-oauth流程" tabindex="-1"><a class="header-anchor" href="#_2-oauth流程"><span>2.OAuth流程</span></a></h2><div class="hint-container tip"><p class="hint-container-title">OAuth 2.0</p><p><a href="https://oauth.net/2/" class="readmore" target="_blank" rel="noopener noreferrer">什么是 OAuth2 ?</a></p><p>MSL统一身份验证基于OAuth2的授权码模式规范设计<br> 若有出入，请联系反馈~</p></div>',16)),a("div",x,[a("ol",null,[a("li",null,[s[3]||(s[3]=i('<h3 id="请求获取授权码-跳转msl用户中心授权" tabindex="-1"><a class="header-anchor" href="#请求获取授权码-跳转msl用户中心授权"><span>请求获取授权码（跳转MSL用户中心授权）</span></a></h3><p>请求跳转授权地址：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-"><span class="line"><span>https://user.mslmc.net/oauth/authorize</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>查询参数:</p>',4)),e(r,null,{default:n(()=>[e(t,{name:"client_id",required:"",type:"String","default-value":"NeQ5v7T72vm4Yi6ADyYAW6m4eVK"},{default:n(()=>[...s[0]||(s[0]=[a("p",null,"客户端ID（第一步申请得到的）。",-1)])]),_:1}),e(t,{name:"state",optional:"",type:"String","default-value":"SiGEWINNEQWQ"},{default:n(()=>[s[1]||(s[1]=a("p",null,"随机字符串，防止CSRF，请求方应当生成并记录此字符串，用于后续验证。",-1)),e(p,{type:"warning",text:"非必须，但强烈建议。"})]),_:1}),e(t,{name:"redirect_uri",optional:"",type:"String","default-value":"https://api.mslmc.cn/api/callback"},{default:n(()=>[s[2]||(s[2]=a("p",null,"登录成功后重新向的地址（一般是编码的地址），若不传此参数则读取App设置的URI地址。",-1)),e(p,{type:"warning",text:"非必须，但强烈建议。"})]),_:1})]),_:1}),s[4]||(s[4]=i('<p>示例拼接地址:</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-"><span class="line"><span>https://user.mslmc.net/oauth/authorize?client_id=NeQ5v7T72vm4Yi6ADyYAW6m4eVK&amp;state=SiGEWINNEQWQ&amp;redirect_uri=https%3a%2f%2fapi.mslmc.cn%2fapi%2fcallback</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><div class="hint-container warning"><p class="hint-container-title">最小示例拼接地址</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-"><span class="line"><span>https://user.mslmc.net/oauth/authorize?client_id=NeQ5v7T72vm4Yi6ADyYAW6m4eVK</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>但是<strong>不建议</strong>这么做，缺少 <mark class="warning">state</mark> 参数可能会导致一些风险（如：<mark class="warning">跨站攻击</mark>）哦~</p></div><p>若地址正确，访问后应该是如下页面:</p><p><img src="'+k+'" alt="image-20250518194152354" width="975" height="735"></p>',5))]),a("li",null,[s[8]||(s[8]=i('<h3 id="使用授权码交换accesstoken" tabindex="-1"><a class="header-anchor" href="#使用授权码交换accesstoken"><span>使用授权码交换AccessToken</span></a></h3><p>登录成功后，MSL用户中心将根据填写的App回调地址重定向并添加 <mark>code</mark> 和 <mark>state</mark> 参数（方法是GET）</p><div class="hint-container tip"><p class="hint-container-title">提示</p><p><mark>code</mark> 有效期只有 <mark>10分钟</mark> 。</p></div><p>MSL用户中心授权成功的重定向示例:</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-"><span class="line"><span>https://api.mslmc.cn/api/callback?code=y94vzbhskzcizEDmJMbWt775tbI&amp;state=iGEWINNEQWQ</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>您的客户端接收到回调后应该核对 <mark>state</mark> 否与请求时的一致，若不一致，请 <mark>拒绝登录请求</mark> 。</p><p>然后需要用拿到的code通过api交换得到AccessToken</p>',7)),e(p,{type:"warning",text:"POST application/x-www-form-urlencoded 或者 application/json"}),s[9]||(s[9]=i('<div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-"><span class="line"><span>https://user.mslmc.net/api/oauth/exchangeAccessToken</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div>',1)),a("div",S,[e(t,{name:"code",required:"",type:"String","default-value":"y94vzbhskzcizEDmJMbWt775tbI"},{default:n(()=>[...s[5]||(s[5]=[a("p",null,"回调拿到的授权码",-1)])]),_:1}),e(t,{name:"client_id",required:"",type:"String","default-value":"NeQ5v7T72vm4Yi6ADyYAW6m4eVK"},{default:n(()=>[...s[6]||(s[6]=[a("p",null,"您在第一步申请的客户端ID",-1)])]),_:1}),e(t,{name:"client_secret",required:"",type:"String","default-value":"FAOFoGDPtTK8Yudlerv..."},{default:n(()=>[...s[7]||(s[7]=[a("p",null,"您在第一步申请的客户端密钥",-1)])]),_:1})]),s[10]||(s[10]=i('<p>返回示例:</p><div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-json"><span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div>',2))])]),s[11]||(s[11]=i(`<p>{ &quot;code&quot;: 200, &quot;msg&quot;: &quot;授权成功&quot;, &quot;access_token&quot;: &quot;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1aWQiOjEsImlhdCI6MTc0NzU1NzY3MiwiZXhwIjoxNzQ3NTYxMjcyfQ.iyX0dIXxrUkr6Dg7HCZ7YNQb2G1u5EYpzh-6wKYJShg&quot;, &quot;expires_in&quot;: 3600, &quot;token_type&quot;: &quot;Bearer&quot;, &quot;scope&quot;: &quot;user_info&quot; }</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-"><span class="line"><span></span></span>
<span class="line"><span>获取到 ==access_token== 即可</span></span>
<span class="line"><span></span></span>
<span class="line"><span>[完整API文档：**获取Access Token - MSL-User-System**](https://apidoc-user.mslmc.cn/297247077e0){.readmore}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>3. ### 获取用户信息</span></span>
<span class="line"><span></span></span>
<span class="line"><span>::: warning 接口适用提醒</span></span>
<span class="line"><span></span></span>
<span class="line"><span>本api接口仅适用于权限类型为 ==用户信息=={.warning} 的应用。</span></span>
<span class="line"><span></span></span>
<span class="line"><span>若您使用的应用类型为所有权限，请参照我们提供的API文档获取用户信息。</span></span>
<span class="line"><span></span></span>
<span class="line"><span>:::</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;Badge type=&quot;tip&quot; text=&quot;GET&quot;  /&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>https://user.mslmc.net/api/oauth/user</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-"><span class="line"><span></span></span>
<span class="line"><span>需要添加 ==Authorization== 请求头</span></span>
<span class="line"><span></span></span>
<span class="line"><span>在 Header 添加参数 Authorization，其值为在 Bearer 之后拼接 Token</span></span>
<span class="line"><span>示例:</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1aWQiOjEsImlhdCI6MTc0NzU1NzY3MiwiZXhwIjoxNzQ3NTYxMjcyfQ.iyX0dIXxrUkr6Dg7HCZ7YNQb2G1u5EYpzh-6wKYJShg</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-"><span class="line"><span></span></span>
<span class="line"><span>返回示例:</span></span>
<span class="line"><span></span></span>
<span class="line"><span>\`\`\`json</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>  &quot;code&quot;: 200,</span></span>
<span class="line"><span>  &quot;msg&quot;: &quot;获取用户信息成功&quot;,</span></span>
<span class="line"><span>  &quot;uid&quot;: 1,</span></span>
<span class="line"><span>  &quot;username&quot;: &quot;小可爱&quot;,</span></span>
<span class="line"><span>  &quot;email&quot;: &quot;user@mslmc.cn&quot;,</span></span>
<span class="line"><span>  &quot;qq&quot;: null,</span></span>
<span class="line"><span>  &quot;score&quot;: 1500,</span></span>
<span class="line"><span>  &quot;avatar&quot;: &quot;https://cravatar.cn/avatar/d31946d60f6051840edc9d41a1261?d=identicon&amp;s=640&quot;,</span></span>
<span class="line"><span>  &quot;regTime&quot;: 1737992780,</span></span>
<span class="line"><span>  &quot;lastLoginTime&quot;: 1745988703,</span></span>
<span class="line"><span>  &quot;permission&quot;: 1,</span></span>
<span class="line"><span>  &quot;realName&quot;: false,</span></span>
<span class="line"><span>  &quot;lastCheckInTime&quot;: null,</span></span>
<span class="line"><span>  &quot;twoFactorAuth&quot;: true</span></span>
<span class="line"><span>}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>请使用 <mark>uid</mark> 字段作为判断用户绑定的参数，这是每位用户唯一的ID，且不会变化。</p><p>其他的信息按需使用/更新即可。</p><p><a href="https://apidoc-user.mslmc.cn/297251390e0" class="readmore" target="_blank" rel="noopener noreferrer">完整API文档：<strong>获取用户信息 - MSL-User-System</strong></a></p>`,9))]),s[13]||(s[13]=a("h2",{id:"_3-快速接入msl登录",tabindex:"-1"},[a("a",{class:"header-anchor",href:"#_3-快速接入msl登录"},[a("span",null,"3.快速接入MSL登录")])],-1)),s[14]||(s[14]=a("h3",{id:"接入到wordpress",tabindex:"-1"},[a("a",{class:"header-anchor",href:"#接入到wordpress"},[a("span",null,"# 接入到WordPress")])],-1)),s[15]||(s[15]=a("p",null,"使用此插件:",-1)),e(d,{repo:"luluxiaoyu/MSL-OAuth2-WordPress"}),s[16]||(s[16]=a("p",null,"下载zip，并在您的wordpress上安装并启用插件。",-1)),s[17]||(s[17]=a("p",null,[a("img",{src:b,alt:"image-20250519124130518",width:"1286",height:"450"})],-1)),s[18]||(s[18]=a("p",null,"在插件设置填写OAuth App信息:",-1)),s[19]||(s[19]=a("p",null,[a("img",{src:f,alt:"image-20250519124318341",width:"1730",height:"1028"})],-1)),s[20]||(s[20]=a("p",null,"回调地址要填写到OAuth App信息中",-1)),s[21]||(s[21]=a("p",null,[a("img",{src:q,alt:"image-20250519124415802",width:"1493",height:"440"})],-1)),s[22]||(s[22]=a("p",null,"两边的信息配置好后，即可进入个人资料页面绑定MSL账户，绑定后即可使用MSL账户快速登录~",-1)),s[23]||(s[23]=a("p",null,[a("img",{src:y,alt:"image-20250519124520689",width:"1550",height:"724"})],-1))])}const L=o(A,[["render",M]]),T=JSON.parse('{"path":"/docs/msl/oauth2/","title":"MSL OAuth 2.0","lang":"zh-CN","frontmatter":{"icon":"arrow-right-to-bracket","title":"MSL OAuth 2.0","createTime":"2025/10/12 21:39:20","permalink":"/docs/msl/oauth2/","description":"TIPS 此处介绍的开发者将自己的服务 接入MSL统一身份验证（即MSL用户中心服务） 第三方登录 。 若您并不知道什么意思，那就别看啦~ 1.申请OAuth App 进入MSL用户中心的OAuth App管理页面，点击添加应用。 MSL OAuth App管理 image-20251111163735501 填写应用的 名字，图标（推荐正方形，需要是...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"MSL OAuth 2.0\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2025-11-11T09:28:09.000Z\\",\\"author\\":[]}"],["meta",{"property":"og:url","content":"https://www.mslmc.cn/docs/msl/oauth2/"}],["meta",{"property":"og:site_name","content":"MSL开服器"}],["meta",{"property":"og:title","content":"MSL OAuth 2.0"}],["meta",{"property":"og:description","content":"TIPS 此处介绍的开发者将自己的服务 接入MSL统一身份验证（即MSL用户中心服务） 第三方登录 。 若您并不知道什么意思，那就别看啦~ 1.申请OAuth App 进入MSL用户中心的OAuth App管理页面，点击添加应用。 MSL OAuth App管理 image-20251111163735501 填写应用的 名字，图标（推荐正方形，需要是..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-11-11T09:28:09.000Z"}],["meta",{"property":"article:modified_time","content":"2025-11-11T09:28:09.000Z"}]]},"readingTime":{"minutes":4.1,"words":1229},"git":{"createdTime":1760280989000,"updatedTime":1762853289000,"contributors":[{"name":"xiaoyu","username":"luluxiaoyu","email":"ljy.xiaoyu@qq.com","commits":5,"avatar":"https://q.qlogo.cn/headimg_dl?dst_uin=1791123970&spec=640&img_type=jpg","url":"https://github.com/luluxiaoyu"}],"changelog":[{"hash":"93c5d64b9eaf5ea28b1b785724b58834dd8e2abf","time":1762853289000,"email":"ljy.xiaoyu@qq.com","author":"xiaoyu","message":"fix: 修复文档参数错误"},{"hash":"aa2b470ebe8d7e896b95d0a169e1904879c22f0b","time":1762852507000,"email":"ljy.xiaoyu@qq.com","author":"xiaoyu","message":"feat: 更新OAuth文档应用权限相关说明"},{"hash":"8873e4219daf446a88ed8d396b9d7716ca1b56c2","time":1760537670000,"email":"ljy.xiaoyu@qq.com","author":"xiaoyu","message":"fix: 修复容器语法问题 &#x26; 移除无用图片资源"},{"hash":"7d26f139fbb8de8961a5af45fb5fb173b237555c","time":1760531593000,"email":"ljy.xiaoyu@qq.com","author":"xiaoyu","message":"docs: 更新 MSL OAuth2文档"},{"hash":"3bfa293d1664e322a8996203bd3cf561de112a83","time":1760280989000,"email":"ljy.xiaoyu@qq.com","author":"xiaoyu","message":"移植旧版文档"}]},"autoDesc":true,"filePathRelative":"docs/msl/oauth2.md","headers":[]}');export{L as comp,T as data};
